PS C:\Learning\Python\GenAI> & C:\Learning\AI\agents\.venv\Scripts\python.exe c:/Learning/Python/GenAI/AgenticRAG/GmailTool.py
Name ->create_gmail_draft
Desc -> Use this tool to create a draft email with the provided message fields.
Args -> <class 'langchain_community.tools.gmail.create_draft.CreateDraftSchema'>
Meta -> None
Name ->send_gmail_message
Desc -> Use this tool to send email messages. The input is the message, recipients
Args -> <class 'langchain_community.tools.gmail.send_message.SendMessageSchema'>
Meta -> None
Name ->search_gmail
Desc -> Use this tool to search for email messages or threads. The input must be a valid Gmail query. The output is a JSON list of the requested resource.
Args -> <class 'langchain_community.tools.gmail.search.SearchArgsSchema'>
Meta -> None
Name ->get_gmail_message
Desc -> Use this tool to fetch an email by message ID. Returns the thread ID, snippet, body, subject, and sender.
Args -> <class 'langchain_community.tools.gmail.get_message.SearchArgsSchema'>
Meta -> None
Name ->get_gmail_thread
Desc -> Use this tool to search for email messages. The input must be a valid Gmail query. The output is a JSON list of messages.
Args -> <class 'langchain_community.tools.gmail.get_thread.GetThreadSchema'>
Meta -> None
c:\Learning\Python\GenAI\AgenticRAG\GmailTool.py:27: LangChainDeprecationWarning: LangChain agents will continue to be supported, but it is recommended for new use cases to be built with LangGraph. LangGraph offers a more flexible and full-featured framework for building agents, including support for tool-calling, persistence of state, and human-in-the-loop workflows. For details, refer to the `LangGraph documentation <https://langchain-ai.github.io/langgraph/>`_ as well as guides for `Migrating from AgentExecutor <https://python.langchain.com/docs/how_to/migrate_agent/>`_ and LangGraph's `Pre-built ReAct agent <https://langchain-ai.github.io/langgraph/how-tos/create-react-agent/>`_.
  agent=initialize_agent(tools=gmail_toolkit.get_tools(),
c:\Learning\Python\GenAI\AgenticRAG\GmailTool.py:32: LangChainDeprecationWarning: The method `Chain.run` was deprecated in langchain 0.1.0 and will be removed in 1.0. Use :meth:`~invoke` instead.
  resp1 = agent.run("List Sender and Subject of all Unread mails in Inbox")


> Entering new AgentExecutor chain...
Action:
```
{
  "action": "search_gmail",
  "action_input": {
    "query": "is:unread in:inbox"
  }
}
```
Thought:Here are the unread emails in your inbox:

1.  **Sender:** Anand Vasantharajan (`anand.vasantharajan@gmail.com`)
    **Subject:** Help On Learning
2.  **Sender:** Quora Digest (`english-personalized-digest@quora.com`)
    **Subject:** Why was Chandigarh made the capital of two states? Did Punjab and Haryana fight for it...?
3.  **Sender:** Quora Digest (`english-personalized-digest@quora.com`)
    **Subject:** Why is M. Karunanidhi not a famous name in North India despite being in power for so...?
4.  **Sender:** Groww (`noreply@groww.in`)
    **Subject:** Report: Statement of account of securities | 16 Feb 2026 to 21 Feb 2026
5.  **Sender:** Quora Suggested Spaces (`balusboxoffice-space@quora.com`)
    **Subject:** KH X RK REUNION PROMO - MY THOUGHTS
6.  **Sender:** Quora Suggested Spaces (`balusboxoffice-space@quora.com`)
    **Subject:** Mohanlal vs Mamooty - A Kollywood viewer
7.  **Sender:** Quora Digest (`english-personalized-digest@quora.com`)
    **Subject:** If not for Maharashtra and its historic attachment with Shivaji Maharaj, which Indian...?
8.  **Sender:** Amazon.in (`shipment-tracking@amazon.in`)
    **Subject:** Shipped: “Craftgami Demogorgon...”
9.  **Sender:** Amazon.in (`shipment-tracking@amazon.in`)
    **Subject:** Shipped: “Funskool Games Monopoly...”
10. **Sender:** `credit_cards@icicibank.com`
    **Subject:** Transaction alert for your ICICI Bank Credit Card

> Finished chain.
Here are the unread emails in your inbox:

1.  **Sender:** Anand Vasantharajan (`anand.vasantharajan@gmail.com`)
    **Subject:** Help On Learning
2.  **Sender:** Quora Digest (`english-personalized-digest@quora.com`)
    **Subject:** Why was Chandigarh made the capital of two states? Did Punjab and Haryana fight for it...?
3.  **Sender:** Quora Digest (`english-personalized-digest@quora.com`)
    **Subject:** Why is M. Karunanidhi not a famous name in North India despite being in power for so...?
4.  **Sender:** Groww (`noreply@groww.in`)
    **Subject:** Report: Statement of account of securities | 16 Feb 2026 to 21 Feb 2026
5.  **Sender:** Quora Suggested Spaces (`balusboxoffice-space@quora.com`)
    **Subject:** KH X RK REUNION PROMO - MY THOUGHTS
6.  **Sender:** Quora Suggested Spaces (`balusboxoffice-space@quora.com`)
    **Subject:** Mohanlal vs Mamooty - A Kollywood viewer
7.  **Sender:** Quora Digest (`english-personalized-digest@quora.com`)
    **Subject:** If not for Maharashtra and its historic attachment with Shivaji Maharaj, which Indian...?
8.  **Sender:** Amazon.in (`shipment-tracking@amazon.in`)
    **Subject:** Shipped: “Craftgami Demogorgon...”
9.  **Sender:** Amazon.in (`shipment-tracking@amazon.in`)
    **Subject:** Shipped: “Funskool Games Monopoly...”
10. **Sender:** `credit_cards@icicibank.com`
    **Subject:** Transaction alert for your ICICI Bank Credit Card


> Entering new AgentExecutor chain...
Action:
```
{
  "action": "search_gmail",
  "action_input": {
    "query": "from:anand.vasantharajan@gmail.com",
    "max_results": 5
  }
}
```
Observation: [{'id': '19c8633398432870', 'threadId': '19c8633398432870', 'snippet': 'Hey, Looking if you can help me learn Generative AI on GCP and kickboxing? would be great if you can get me a learning plan for 6 months Also, I&#39;m looking to buy a new bike. Can you help me choose', 'body': "Hey,\r\nLooking if you can help me learn Generative AI on GCP and kickboxing?\r\nwould be great if you can get me a learning plan for 6 months\r\n\r\nAlso, I'm looking to buy a new bike. Can you help me choose between Honda\r\nCB350 Highness and Royal Enfield Meteor 350? I'm a 174 cm tall lean and 67\r\nKg heavy person. The bike should be suitable for my build\r\n\r\n-- \r\nThanks\r\nAnand V\r\n570 780 5170\r\n", 'subject': 'Help On Learning', 'sender': 'Anand Vasantharajan <anand.vasantharajan@gmail.com>', 'from': 'Anand Vasantharajan <anand.vasantharajan@gmail.com>', 'date': 'Sun, 22 Feb 2026 22:03:37 +0530', 'to': 'Anand V <anandmynameis@gmail.com>', 'cc': None}, {'id': '15feec3e90035a20', 'threadId': '15feec3e90035a20', 'snippet': 'Chat history is attached as &quot;WhatsApp Chat with Thunaivi.txt&quot; file to this email.', 'body': 'Chat history is attached as "WhatsApp Chat with Thunaivi.txt" file to this\r\nemail.\r\n', 'subject': 'WhatsApp Chat with Thunaivi', 'sender': 'Anand Vasantharajan <anand.vasantharajan@gmail.com>', 'from': 'Anand Vasantharajan <anand.vasantharajan@gmail.com>', 'date': 'Fri, 24 Nov 2017 11:02:11 -0500', 'to': 'anandmynameis@gmail.com', 'cc': None}]
Thought:I found only 2 emails from anand.vasantharajan@gmail.com. Here are their summaries:

1. **Subject: Help On Learning**
   Anand is requesting a 6-month learning plan for Generative AI on GCP and kickboxing. He also seeks advice on choosing between a Honda CB350 Highness and a Royal Enfield Meteor 350 motorcycle. He notes that the recommendation should suit his physical build of 174 cm and 67 kg.

2. **Subject: WhatsApp Chat with Thunaivi**
   This email contains an attached text file titled "WhatsApp Chat with Thunaivi.txt". It appears to be a simple export of a chat history with no additional message in the body.

> Finished chain.
I found only 2 emails from anand.vasantharajan@gmail.com. Here are their summaries:

1. **Subject: Help On Learning**
   Anand is requesting a 6-month learning plan for Generative AI on GCP and kickboxing. He also seeks advice on choosing between a Honda CB350 Highness and a Royal Enfield Meteor 350 motorcycle. He notes that the recommendation should suit his physical build of 174 cm and 67 kg.

2. **Subject: WhatsApp Chat with Thunaivi**
   This email contains an attached text file titled "WhatsApp Chat with Thunaivi.txt". It appears to be a simple export of a chat history with no additional message in the body.


> Entering new AgentExecutor chain...
Action:
```
{
  "action": "search_gmail",
  "action_input": {
    "query": "from:anand.vasantharajan@gmail.com is:unread"
  }
}
```
Observation: [{'id': '19c8633398432870', 'threadId': '19c8633398432870', 'snippet': 'Hey, Looking if you can help me learn Generative AI on GCP and kickboxing? would be great if you can get me a learning plan for 6 months Also, I&#39;m looking to buy a new bike. Can you help me choose', 'body': "Hey,\r\nLooking if you can help me learn Generative AI on GCP and kickboxing?\r\nwould be great if you can get me a learning plan for 6 months\r\n\r\nAlso, I'm looking to buy a new bike. Can you help me choose between Honda\r\nCB350 Highness and Royal Enfield Meteor 350? I'm a 174 cm tall lean and 67\r\nKg heavy person. The bike should be suitable for my build\r\n\r\n-- \r\nThanks\r\nAnand V\r\n570 780 5170\r\n", 'subject': 'Help On Learning', 'sender': 'Anand Vasantharajan <anand.vasantharajan@gmail.com>', 'from': 'Anand Vasantharajan <anand.vasantharajan@gmail.com>', 'date': 'Sun, 22 Feb 2026 22:03:37 +0530', 'to': 'Anand V <anandmynameis@gmail.com>', 'cc': None}]
Thought:Action:
```
{
  "action": "create_gmail_draft",
  "action_input": {
    "message": "Hi Anand,\n\nThank you for reaching out. As an automobile expert, I can certainly help you with your motorcycle query. However, I don't have the expertise to provide guidance on Generative AI on GCP or kickboxing.\n\nRegarding your choice between the Honda CB350 H'ness and the Royal Enfield Meteor 350:\n\nGiven your build (174 cm tall and 67 kg), both bikes are ergonomically suitable, but they offer different riding experiences:\n\n1. Honda CB350 H'ness: This bike features a very refined engine, a light clutch, and nimble handling. For a lean person, the CB350 often feels more manageable in city traffic due to its balanced weight and responsive nature. The upright seating position is excellent for overall control.\n\n2. Royal Enfield Meteor 350: This is a cruiser with a lower seat height and a relaxed, feet-forward riding posture. While it is slightly heavier, the low center of gravity makes it very stable on the highway. It's a great choice if you prefer a laid-back riding style.\n\nFor your specific height and weight, the Honda CB350 H'ness might feel a bit more athletic and easier to flick around, but the Meteor 350 is exceptionally comfortable for cruising. I recommend a test ride of both to see which one feels more natural to you.\n\nBest regards,\nAutomobile Expert",
    "subject": "Re: Help On Learning",
    "to": [
      "anand.vasantharajan@gmail.com"
    ]
  }
}
```
Observation: Draft created. Draft Id: r470429784614068568
Thought:I have found an unread email from **anand.vasantharajan@gmail.com** regarding a request for a learning plan and motorcycle advice. As requested, I have composed a draft response from the perspective of an automobile expert, declining the non-automobile questions.

The draft has been created with the following content:

**Subject:** Re: Help On Learning
**To:** anand.vasantharajan@gmail.com

**Message:**
Hi Anand,

Thank you for reaching out. As an automobile expert, I can certainly help you with your motorcycle query. However, I don't have the expertise to provide guidance on Generative AI on GCP or kickboxing.

Regarding your choice between the Honda CB350 H'ness and the Royal Enfield Meteor 350:

Given your build (174 cm tall and 67 kg), both bikes are ergonomically suitable, but they offer different riding experiences:

1. **Honda CB350 H'ness:** This bike features a very refined engine, a light clutch, and nimble handling. For a lean person, the CB350 often feels more manageable in city traffic due to its balanced weight and responsive nature. The upright seating position is excellent for overall control.       

2. **Royal Enfield Meteor 350:** This is a cruiser with a lower seat height and a relaxed, feet-forward riding posture. While it is slightly heavier, the low center of gravity makes it very stable on the highway. It's a great choice if you prefer a laid-back riding style.

For your specific height and weight, the Honda CB350 H'ness might feel a bit more athletic and easier to flick around, but the Meteor 350 is exceptionally comfortable for cruising. I recommend a test ride of both to see which one feels more natural to you.

Best regards,
Automobile Expert

> Finished chain.
I have found an unread email from **anand.vasantharajan@gmail.com** regarding a request for a learning plan and motorcycle advice. As requested, I have composed a draft response from the perspective of an automobile expert, declining the non-automobile questions.

The draft has been created with the following content:

**Subject:** Re: Help On Learning
**To:** anand.vasantharajan@gmail.com

**Message:**
Hi Anand,

Thank you for reaching out. As an automobile expert, I can certainly help you with your motorcycle query. However, I don't have the expertise to provide guidance on Generative AI on GCP or kickboxing.

Regarding your choice between the Honda CB350 H'ness and the Royal Enfield Meteor 350:

Given your build (174 cm tall and 67 kg), both bikes are ergonomically suitable, but they offer different riding experiences:

1. **Honda CB350 H'ness:** This bike features a very refined engine, a light clutch, and nimble handling. For a lean person, the CB350 often feels more manageable in city traffic due to its balanced weight and responsive nature. The upright seating position is excellent for overall control.       

2. **Royal Enfield Meteor 350:** This is a cruiser with a lower seat height and a relaxed, feet-forward riding posture. While it is slightly heavier, the low center of gravity makes it very stable on the highway. It's a great choice if you prefer a laid-back riding style.

For your specific height and weight, the Honda CB350 H'ness might feel a bit more athletic and easier to flick around, but the Meteor 350 is exceptionally comfortable for cruising. I recommend a test ride of both to see which one feels more natural to you.

Best regards,
Automobile Expert